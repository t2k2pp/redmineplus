# Redmineチケット可視化ダッシュボード

RedmineのAPIを使用してチケットデータを取得し、Streamlitで可視化するダッシュボードアプリケーションです。

## 機能

### 1. チケットデータの可視化
**基本分析**
- **ステータス別円グラフ**: チケットのステータス分布
- **優先度別棒グラフ**: 優先度別のチケット数
- **トラッカー別棒グラフ**: トラッカー別チケット数

**担当者・プロジェクト分析**
- **担当者別横棒グラフ**: 担当者別チケット数（上位10名）
- **プロジェクト別円グラフ**: プロジェクト別チケット分布
- **工数分析グラフ**: 担当者別の予定工数・実績工数・チケット数

**スケジュール・期限分析**
- **月別期限チケット数**: 期限日ベースの棒グラフ
- **進捗率 vs 期限**: 期限超過リスクの散布図
- **ガントチャート**: チケットのスケジュール表示（上位20件）

### 2. フィルター機能
- プロジェクト別フィルター
- ステータス別フィルター

### 3. 概要統計・アラート
- 総チケット数
- 未完了チケット数
- 平均進捗率
- 総実績工数
- **期限超過アラート**: 期限を過ぎた未完了チケットの表示
- **期限間近アラート**: 7日以内に期限が来る未完了チケットの表示

### 4. チケット詳細確認機能
- **チケット選択**: 一覧から詳細確認したいチケットを選択
- **詳細表示**: 基本情報、担当・日程、説明、コメント履歴を表示
- **インタラクティブUI**: 長い説明やコメントは折りたたみ表示

### 5. エクスポート機能
- **CSVエクスポート**: フィルター条件に基づいたチケット一覧をCSV形式でダウンロード

### 6. PowerPoint帳票出力
- **チケット選択→帳票生成**: 詳細確認したチケットからそのまま帳票出力
- **問題管理票形式**: 画像レイアウトに基づいた1ページの帳票
- **コメント履歴対応**: チケットのコメント履歴も含めて出力

## ファイル構成

```
tools/
├── streamlit_app.py      # メインのStreamlitアプリ
├── redmine_client.py     # Redmine APIクライアント
├── ppt_generator.py      # PowerPoint生成モジュール
├── requirements.txt      # 必要なライブラリ一覧
├── run_app.py           # アプリ起動スクリプト
├── test_redmine_api.py  # API接続テスト
└── README.md           # このファイル
```

## セットアップ・実行方法

### 1. 自動起動（推奨）
```bash
python run_app.py
```

### 2. 手動起動
```bash
# ライブラリインストール
pip install -r requirements.txt

# アプリ起動 (正しいコマンド)
streamlit run streamlit_app.py
# または
python -m streamlit run streamlit_app.py
```

**注意**: `streamlit run app.py` ではなく `streamlit run streamlit_app.py` が正しいコマンドです。

## 🌐 オンラインデモ・デプロイメント

### Streamlit Community Cloud (推奨)
1. [Streamlit Community Cloud](https://share.streamlit.io) にアクセス
2. GitHubアカウントでログイン
3. `t2k2pp/redmineplus` リポジトリを選択
4. `streamlit_app.py` を指定してデプロイ
5. 無料で利用可能

### GitHub Pages
プロジェクトの紹介ページ: https://t2k2pp.github.io/redmineplus

**注意**: GitHub Pagesではアプリの実行はできません。紹介ページのみです。

## 設定

アプリ内でRedmineの接続設定を変更する場合は、以下のファイルを編集してください：

- `streamlit_app.py`: L11のRedmineClientインスタンス化部分
- `redmine_client.py`: RedmineClientクラス

現在の設定:
- **RedmineURL**: http://localhost:3000
- **APIキー**: d12341dfd7bfa3fabee13d78732989fd913e6bae

## 使用方法

1. **アプリ起動**: `streamlit run streamlit_app.py` でアプリを起動
2. **ウェルカム画面**: 初回起動時にウェルカム画面が表示されます
3. **接続設定**: 
   - RedmineサーバーのURL（例: http://localhost:3000）
   - RedmineのAPIキーを入力
   - 「ダッシュボードを開始」ボタンをクリック
4. **ダッシュボード操作**:
   - サイドバーでプロジェクトやステータスでフィルタリング
   - 各種グラフでチケットの状況を確認
   - **チケット一覧タブ**: チケットを選択して詳細確認
   - **選択チケット**: 基本情報、説明、コメント履歴を表示
   - **帳票出力**: 詳細確認画面からPowerPoint帳票を直接生成
   - **CSVエクスポートタブ**: フィルター条件でのCSVダウンロード
5. **設定変更**: 右上の「設定変更」ボタンで接続設定を変更可能

## 必要な環境

- Python 3.7以上
- Redmine（API機能が有効）
- インターネット接続（ライブラリダウンロード用）

## トラブルシューティング

### API接続エラーが発生する場合
1. RedmineサーバーのURL、APIキーを確認
2. RedmineのAPI機能が有効になっているか確認
3. ファイアウォール設定を確認

### グラフが表示されない場合
1. チケットデータが正常に取得されているか確認
2. フィルター条件を緩和してデータがあるか確認

### PowerPoint生成でエラーが発生する場合
1. 指定したチケットIDが存在するか確認
2. python-pptxライブラリが正常にインストールされているか確認